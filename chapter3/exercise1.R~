library(tidyr)
library(stringdist)

#Helper to correct incorrect spelling into standard spellings.
#Picks the closest spelling to correct, by using the stringdist lib.
getFixedName <- function(currentName) {
  fixedNames <- c('van houten','philips','akzo','unilever')

  df <- data.frame(fixedNames,sapply(fixedNames,function(x) {stringsim(x,currentName)}),stringsAsFactors = FALSE)
  df <- df[order(df[2],decreasing=T),]
  return( df[1,1])

}


mydata = read.csv("refine_original.csv")

#correct company names
mydata$company <- lapply(mydata$company,function (x) {getFixedName(x)})

#separate(mydata,Product.code...number,c('product_code','product_number'),sep='-')

#h <- hashmap(c("p","x","v","q"),c("Smartphone","TV", "Laptop" ,"Tablet"))

#lapply(mydata$product_code,function (x) {h[[x]]})
#mydata$product_cat <- unlist(lapply(mydata$product_code,function (x) {h[[x]]}))
#mydata <- unite(mydata,full_address,address,city,country,sep=',')

#mydata$company_philips <- lapply(mydata$company,function (x) {as.integer(x == "philips")})

#write cleanedup dataframe
write.csv(mydata, file = "refine_clean.csv")
